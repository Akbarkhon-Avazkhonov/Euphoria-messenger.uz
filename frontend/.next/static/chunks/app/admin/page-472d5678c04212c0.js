(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[3],{49633:function(e,t,r){Promise.resolve().then(r.bind(r,60529)),Promise.resolve().then(r.bind(r,80678)),Promise.resolve().then(r.bind(r,59691))},72645:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M20 7h-5V4c0-1.1-.9-2-2-2h-2c-1.1 0-2 .9-2 2v3H4c-1.1 0-2 .9-2 2v11c0 1.1.9 2 2 2h16c1.1 0 2-.9 2-2V9c0-1.1-.9-2-2-2M9 12c.83 0 1.5.67 1.5 1.5S9.83 15 9 15s-1.5-.67-1.5-1.5S8.17 12 9 12m3 6H6v-.75c0-1 2-1.5 3-1.5s3 .5 3 1.5zm1-9h-2V4h2zm5 7.5h-4V15h4zm0-3h-4V12h4z"}),"Badge")},18947:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M3 17.46v3.04c0 .28.22.5.5.5h3.04c.13 0 .26-.05.35-.15L17.81 9.94l-3.75-3.75L3.15 17.1q-.15.15-.15.36M20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34a.996.996 0 0 0-1.41 0l-1.83 1.83 3.75 3.75z"}),"EditRounded")},64233:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M15.41 16.59 10.83 12l4.58-4.59L14 6l-6 6 6 6z"}),"KeyboardArrowLeft")},96703:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M8.59 16.59 13.17 12 8.59 7.41 10 6l6 6-6 6z"}),"KeyboardArrowRight")},12428:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"m20.68 9.27.01-.06c.16-.62-.3-1.21-.93-1.21H17l.7-2.79c.15-.62-.31-1.21-.94-1.21-.45 0-.83.3-.94.73L15 8h-4l.7-2.79c.15-.62-.31-1.21-.94-1.21-.45 0-.83.3-.94.73L9 8H5.76c-.45 0-.84.3-.94.73l-.02.06c-.15.62.31 1.21.94 1.21H8.5l-1 4H4.26c-.45 0-.83.3-.94.73l-.02.06c-.15.62.31 1.21.94 1.21H7l-.7 2.79c-.15.62.31 1.21.94 1.21.45 0 .83-.3.94-.73L9 16h4l-.7 2.79c-.15.62.31 1.21.94 1.21.45 0 .83-.3.94-.73L15 16h3.24c.45 0 .83-.3.94-.73l.01-.06c.15-.61-.31-1.21-.94-1.21H15.5l1-4h3.24c.45 0 .84-.3.94-.73M13.5 14h-4l1-4h4z"}),"NumbersRounded")},28561:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M15 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4m-9-2V8c0-.55-.45-1-1-1s-1 .45-1 1v2H2c-.55 0-1 .45-1 1s.45 1 1 1h2v2c0 .55.45 1 1 1s1-.45 1-1v-2h2c.55 0 1-.45 1-1s-.45-1-1-1zm9 4c-2.67 0-8 1.34-8 4v1c0 .55.45 1 1 1h14c.55 0 1-.45 1-1v-1c0-2.66-5.33-4-8-4"}),"PersonAddRounded")},79335:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14"}),"Search")},20073:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M19.5 12c0-.23-.01-.45-.03-.68l1.86-1.41c.4-.3.51-.86.26-1.3l-1.87-3.23c-.25-.44-.79-.62-1.25-.42l-2.15.91c-.37-.26-.76-.49-1.17-.68l-.29-2.31c-.06-.5-.49-.88-.99-.88h-3.73c-.51 0-.94.38-1 .88l-.29 2.31c-.41.19-.8.42-1.17.68l-2.15-.91c-.46-.2-1-.02-1.25.42L2.41 8.62c-.25.44-.14.99.26 1.3l1.86 1.41c-.02.22-.03.44-.03.67s.01.45.03.68l-1.86 1.41c-.4.3-.51.86-.26 1.3l1.87 3.23c.25.44.79.62 1.25.42l2.15-.91c.37.26.76.49 1.17.68l.29 2.31c.06.5.49.88.99.88h3.73c.5 0 .93-.38.99-.88l.29-2.31c.41-.19.8-.42 1.17-.68l2.15.91c.46.2 1 .02 1.25-.42l1.87-3.23c.25-.44.14-.99-.26-1.3l-1.86-1.41c.03-.23.04-.45.04-.68m-7.46 3.5c-1.93 0-3.5-1.57-3.5-3.5s1.57-3.5 3.5-3.5 3.5 1.57 3.5 3.5-1.57 3.5-3.5 3.5"}),"SettingsRounded")},34641:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M16 17.01V11c0-.55-.45-1-1-1s-1 .45-1 1v6.01h-1.79c-.45 0-.67.54-.35.85l2.79 2.78c.2.19.51.19.71 0l2.79-2.78c.32-.31.09-.85-.35-.85zM8.65 3.35 5.86 6.14c-.32.31-.1.85.35.85H8V13c0 .55.45 1 1 1s1-.45 1-1V6.99h1.79c.45 0 .67-.54.35-.85L9.35 3.35c-.19-.19-.51-.19-.7 0"}),"SwapVertRounded")},60906:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M12 6.5c2.76 0 5 2.24 5 5 0 .51-.1 1-.24 1.46l3.06 3.06c1.39-1.23 2.49-2.77 3.18-4.53C21.27 7.11 17 4 12 4c-1.27 0-2.49.2-3.64.57l2.17 2.17c.47-.14.96-.24 1.47-.24M2.71 3.16c-.39.39-.39 1.02 0 1.41l1.97 1.97C3.06 7.83 1.77 9.53 1 11.5 2.73 15.89 7 19 12 19c1.52 0 2.97-.3 4.31-.82l2.72 2.72c.39.39 1.02.39 1.41 0s.39-1.02 0-1.41L4.13 3.16c-.39-.39-1.03-.39-1.42 0M12 16.5c-2.76 0-5-2.24-5-5 0-.77.18-1.5.49-2.14l1.57 1.57c-.03.18-.06.37-.06.57 0 1.66 1.34 3 3 3 .2 0 .38-.03.57-.07L14.14 16c-.65.32-1.37.5-2.14.5m2.97-5.33c-.15-1.4-1.25-2.49-2.64-2.64z"}),"VisibilityOffRounded")},80798:function(e,t,r){"use strict";var n=r(94630),s=r(57437);t.Z=(0,n.Z)((0,s.jsx)("path",{d:"M12 4C7 4 2.73 7.11 1 11.5 2.73 15.89 7 19 12 19s9.27-3.11 11-7.5C21.27 7.11 17 4 12 4m0 12.5c-2.76 0-5-2.24-5-5s2.24-5 5-5 5 2.24 5 5-2.24 5-5 5m0-8c-1.66 0-3 1.34-3 3s1.34 3 3 3 3-1.34 3-3-1.34-3-3-3"}),"VisibilityRounded")},80678:function(e,t,r){"use strict";r.d(t,{default:function(){return $}});var n=r(57437),s=r(2265),a=r(87349),l=r(1958),i=r(74183),o=r(18154),c=r(11608),d=r(25002),u=r(53092),h=r(36164),x=r(23345),p=r(59456),m=r(28561),j=r(82323),f=r(80798),Z=r(60906),g=r(72645),v=r(50295),y=r(55075),b=r(84673),w=r(20460),C=r(1119),P=r(74610),S=r(13133),k=r(73873),z=r(31098);let D="Input";function F(e){return(0,k.d)(D,e)}(0,z.s)(D,["root","formControl","focused","disabled","error","multiline","input","inputMultiline","inputTypeSearch","adornedStart","adornedEnd"]);var T=r(24861),A=r(16294),N=r(20801),R=r(30631);let M=["aria-describedby","aria-label","aria-labelledby","autoComplete","autoFocus","className","defaultValue","disabled","endAdornment","error","id","multiline","name","onClick","onChange","onKeyDown","onKeyUp","onFocus","onBlur","placeholder","readOnly","required","startAdornment","value","type","rows","slotProps","slots","minRows","maxRows"],L=e=>{let{disabled:t,error:r,focused:n,formControlContext:s,multiline:a,startAdornment:l,endAdornment:i}=e;return(0,N.Z)({root:["root",t&&"disabled",r&&"error",n&&"focused",!!s&&"formControl",a&&"multiline",!!l&&"adornedStart",!!i&&"adornedEnd"],input:["input",t&&"disabled",a&&"multiline"]},(0,R.T)(F))},O=s.forwardRef(function(e,t){var r,s,a;let{"aria-describedby":l,"aria-label":i,"aria-labelledby":o,autoComplete:c,autoFocus:d,className:u,defaultValue:h,disabled:x,endAdornment:p,error:m,id:j,multiline:f=!1,name:Z,onClick:g,onChange:v,onKeyDown:y,onKeyUp:b,onFocus:w,onBlur:k,placeholder:z,readOnly:D,required:F,startAdornment:N,value:R,type:O,rows:q,slotProps:E={},slots:I={},minRows:V,maxRows:H}=e,W=(0,P.Z)(e,M),{getRootProps:B,getInputProps:_,focused:U,formControlContext:K,error:Y,disabled:J}=(0,T.G)({disabled:x,defaultValue:h,error:m,onBlur:k,onClick:g,onChange:v,onFocus:w,required:F,value:R}),G=f?void 0:null!=O?O:"text",X=(0,C.Z)({},e,{disabled:J,error:Y,focused:U,formControlContext:K,multiline:f,type:G}),$=L(X),Q={"aria-describedby":l,"aria-label":i,"aria-labelledby":o,autoComplete:c,autoFocus:d,id:j,onKeyDown:y,onKeyUp:b,name:Z,placeholder:z,readOnly:D,type:G},ee=null!=(r=I.root)?r:"div",et=(0,A.y)({elementType:ee,getSlotProps:B,externalSlotProps:E.root,externalForwardedProps:W,additionalProps:{ref:t},ownerState:X,className:[$.root,u]}),er=f?null!=(s=I.textarea)?s:"textarea":null!=(a=I.input)?a:"input",en=(0,A.y)({elementType:er,getSlotProps:e=>_((0,C.Z)({},Q,e)),externalSlotProps:E.input,additionalProps:(0,C.Z)({rows:f?q:void 0},f&&!(0,S.X)(er)&&{minRows:q||V,maxRows:q||H}),ownerState:X,className:$.input});return(0,n.jsxs)(ee,(0,C.Z)({},et,{children:[N,(0,n.jsx)(er,(0,C.Z)({},en)),p]}))});var q=r(56063),E=r(48174);let I=(0,r(94143).Z)("MuiBox",["root"]),V=(0,E.Z)({defaultClassName:I.root,generateClassName:q.Z.generate});function H(e){let{separator:t,length:r,value:a,onChange:l}=e,i=s.useRef(Array(r).fill(null)),o=e=>{let t=i.current[e];null==t||t.focus()},c=e=>{let t=i.current[e];null==t||t.select()},d=(e,t)=>{switch(/[0-9]/.test(e.key)||["ArrowUp","ArrowDown","ArrowLeft","ArrowRight","Backspace","Delete","Tab"].includes(e.key)||e.preventDefault(),e.key){case"ArrowUp":case"ArrowDown":case" ":e.preventDefault();break;case"ArrowLeft":e.preventDefault(),t>0&&(o(t-1),c(t-1));break;case"ArrowRight":e.preventDefault(),t<r-1&&(o(t+1),c(t+1));break;case"Delete":case"Backspace":e.preventDefault();let n=a.split("");n[t]="",l(n.join("")),t>0&&(o(t-1),c(t-1))}},u=(e,t)=>{let n=e.target.value;if(!/^\d*$/.test(n))return;let s=a.split(""),i=n[n.length-1];s[t]=i,l(s.join("")),""!==n&&t<r-1&&o(t+1)},h=(e,t)=>{c(t)},x=(e,t)=>{e.preventDefault();let n=e.clipboardData;if(n.types.includes("text/plain")){let e=n.getData("text/plain").replace(/\D/g,"");e=e.substring(0,r).trim();let i=a.split("");for(let n=t;n<r;n++){var s;let r=null!==(s=e[n-t])&&void 0!==s?s:"";i[n]=r}l(i.join(""))}};return(0,n.jsx)(V,{sx:{display:"flex",gap:1,alignItems:"center"},children:Array(r).fill(null).map((e,l)=>{var o;return(0,n.jsxs)(s.Fragment,{children:[(0,n.jsx)(O,{slots:{input:B},"aria-label":"Digit ".concat(l+1," of OTP"),slotProps:{input:{ref:e=>{i.current[l]=e},onKeyDown:e=>d(e,l),onChange:e=>u(e,l),onClick:e=>h(e,l),onPaste:e=>x(e,l),value:null!==(o=a[l])&&void 0!==o?o:"",type:"tel",maxLength:1}}}),l===r-1?null:t]},l)})})}function W(e){return(0,n.jsx)(V,{sx:{display:"flex",flexDirection:"column",gap:2,margin:"auto",my:2},children:(0,n.jsx)(H,{separator:(0,n.jsx)("span",{children:"-"}),value:e.otp,onChange:e.setOtp,length:5})})}let B=(0,r(88195).Z)("input")(e=>{let{theme:t}=e;return"\n  width: 40px;\n  font-family: 'IBM Plex Sans', sans-serif;\n  font-size: 0.875rem;\n  font-weight: 400;\n  line-height: 1.5;\n  padding: 8px 0px;\n  border-radius: 8px;\n  text-align: center;\n  color: ".concat("dark"===t.palette.mode?"#C7D0DD":"#303740",";\n  background: ").concat("dark"===t.palette.mode?"#303740":"#fff",";\n  border: 1px solid ").concat("dark"===t.palette.mode?"#434D5B":"#DAE2ED",";\n  box-shadow: 0px 2px 4px ").concat("dark"===t.palette.mode?"rgba(0,0,0, 0.5)":"rgba(0,0,0, 0.05)",";\n\n  &:hover {\n    border-color: #3399FF;\n  }\n\n  &:focus {\n    border-color: #3399FF;\n    box-shadow: 0 0 0 3px ").concat("dark"===t.palette.mode?"#0072E5":"#80BFFF",";\n  }\n\n  &:focus-visible {\n    outline: 0;\n  }\n")});var _=r(75186);async function U(e,t){return await fetch("".concat("https://api.euphoria-messenger.uz","/tg-auth/register/").concat(e),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({phoneNumber:t})}).then(e=>e.json())}function K(e){let[t,r]=s.useState(""),d=async()=>{if(!e.phoneNumber){_.ZP.error("Все поля обязательны");return}e.setOpen(!0);try{let t=await U(e.login,e.phoneNumber);t.message?_.ZP.success(t.message):_.ZP.error("Ошибка при создании пользователя")}catch(e){console.error("Failed to create user:",e),_.ZP.error("Ошибка при создании пользователя")}},u=async()=>{if(!t){_.ZP.error("Все поля обязательны");return}try{let r=await fetch("".concat("https://api.euphoria-messenger.uz","/tg-auth/verify/").concat(e.login),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({phoneCode:t})}).then(e=>e.json());r.message?(e.setOpen(!1),e.setClose(!0),_.ZP.success(r.message)):_.ZP.error("Ошибка при создании пользователя")}catch(e){console.error("Failed to create user:",e),_.ZP.error("Ошибка при создании пользователя")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{"aria-label":"edit",color:"primary",size:"md",sx:{display:{xs:"none",sm:"unset"}},onClick:d,children:"Получить код"}),(0,n.jsx)(a.ZP,{open:e.open,children:(0,n.jsxs)(i.Z,{sx:{maxWidth:{xs:"94%",sm:"400px"},width:"100%",overflowY:"auto"},children:[(0,n.jsx)(o.Z,{color:"primary",level:"h4",children:"Введите код "}),(0,n.jsxs)(c.Z,{spacing:2,children:[(0,n.jsx)(b.Z,{sx:{textAlign:"center"},children:(0,n.jsx)(W,{otp:t,setOtp:r})}),(0,n.jsx)(l.Z,{type:"submit",color:"primary",fullWidth:!0,onClick:u,children:"Добавить"})]})]})})]})}var Y=(0,r(94630).Z)((0,n.jsx)("path",{d:"M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2m0 15c-.55 0-1-.45-1-1v-4c0-.55.45-1 1-1s1 .45 1 1v4c0 .55-.45 1-1 1m1-8h-2V7h2z"}),"InfoRounded");async function J(e,t,r,n){return await fetch("".concat("https://api.euphoria-messenger.uz","/users/create-user"),{method:"POST",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:e,login:t,password:r,role:n})}).then(e=>e.json())}function G(e){let[t,r]=s.useState(""),[d,u]=s.useState(!1),h=async()=>{if(!e.name||!e.login||!e.password||!e.role){_.ZP.error("Все поля обязательны");return}try{let t=await J(e.name,e.login,e.password,e.role);t.message?(_.ZP.success(t.message),e.setSubmitting(!0)):_.ZP.error("Ошибка при создании пользователя")}catch(e){console.error("Failed to create user:",e),_.ZP.error("Ошибка при создании пользователя")}};return(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{"aria-label":"edit",color:"primary",size:"md",onClick:h,children:"Добавить пользователя"}),(0,n.jsx)(a.ZP,{open:e.submitting,children:(0,n.jsxs)(i.Z,{sx:{maxWidth:{xs:"94%",sm:"400px"},width:"100%",overflowY:"auto"},children:[(0,n.jsx)(o.Z,{color:"primary",level:"h4",children:"Введите номер телефона"}),(0,n.jsx)(v.Z,{color:"success",variant:"soft",sx:{fontSize:14,fontWeight:600},startDecorator:(0,n.jsx)(Y,{sx:{fontSize:24}}),children:(0,n.jsx)(y.ZP,{children:"На этот номер отправиться код !"})}),(0,n.jsxs)(c.Z,{spacing:2,children:[(0,n.jsx)(b.Z,{children:(0,n.jsx)(w.Z,{phone:t,setPhone:r})}),(0,n.jsx)(K,{open:d,setOpen:u,login:e.login,phoneNumber:t,setClose:e.setClose})]})]})})]})}async function X(){return await fetch("".concat("https://api.euphoria-messenger.uz","/roles/allNames"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(e=>e.json())}function $(){let[e,t]=s.useState(!1),[r,v]=s.useState(!1),[y,b]=s.useState(""),[w,C]=s.useState(""),[P,S]=s.useState(""),[k,z]=s.useState(""),[D,F]=s.useState(!0),[T,A]=s.useState([]),[N,R]=s.useState(!1),[M,L]=s.useState(!1);return s.useEffect(()=>{(async()=>{try{let e=await X();A(e.data),F(!1)}catch(e){console.error("Failed to fetch roles:",e),F(!1)}})()},[]),s.useEffect(()=>{M&&(t(!1),R(!1),C(""),S(""),z(""),b(""),L(!1),window.location.reload())},[M]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(l.Z,{startDecorator:(0,n.jsx)(m.Z,{}),onClick:()=>t(!0),size:"sm",children:"Добавить"}),(0,n.jsx)(a.ZP,{open:e,onClose:()=>t(!1),children:(0,n.jsxs)(i.Z,{sx:{maxWidth:{xs:"94%",sm:"400px"},width:"100%",overflowY:"auto"},children:[(0,n.jsxs)(o.Z,{color:"primary",level:"h4",children:["Добавить пользователя",(0,n.jsx)(m.Z,{sx:{fontSize:24},color:"primary"})]}),(0,n.jsxs)(c.Z,{spacing:2,children:[(0,n.jsx)(d.Z,{required:!0,children:"Имя пользователя"}),(0,n.jsx)(u.ZP,{autoFocus:!0,required:!0,onChange:e=>C(e.target.value),value:w,endDecorator:(0,n.jsx)(g.Z,{})}),(0,n.jsx)(d.Z,{required:!0,children:"Логин"}),(0,n.jsx)(u.ZP,{required:!0,onChange:e=>S(e.target.value),value:P,endDecorator:(0,n.jsx)(j.Z,{})}),(0,n.jsx)(d.Z,{required:!0,children:"Пароль"}),(0,n.jsx)(u.ZP,{required:!0,onChange:e=>z(e.target.value),value:k,type:r?"text":"password",endDecorator:(0,n.jsx)(h.ZP,{variant:"plain","aria-label":r?"hide password":"show password",color:"neutral",size:"sm",onClick:()=>{v(!r)},children:r?(0,n.jsx)(f.Z,{}):(0,n.jsx)(Z.Z,{})})}),(0,n.jsx)(d.Z,{required:!0,children:"Выберите роль"}),(0,n.jsx)(x.Z,{name:"role",required:!0,sx:{minWidth:200},value:y,onChange:(e,t)=>b(t),disabled:D,children:D?(0,n.jsx)(p.Z,{value:"",disabled:!0,children:"Загрузка..."}):T.map(e=>(0,n.jsx)(p.Z,{value:e.name,children:e.name},e.id))}),(0,n.jsx)(G,{name:w,login:P,password:k,role:y,submitting:N,setSubmitting:R,setClose:L})]})]})})]})}},59691:function(e,t,r){"use strict";r.d(t,{default:function(){return q}});var n=r(57437),s=r(2265),a=r(5481),l=r(1958),i=r(84673),o=r(53092),c=r(71779),d=r(66500),u=r(36164),h=r(55075),x=r(79335),p=r(96703),m=r(64233),j=r(20073),f=r(12428),Z=r(59456),g=r(36766),v=r(34641),y=r(23345),b=r(87349),w=r(74183),C=r(18154),P=r(11608),S=r(25002),k=r(28561),z=r(82323),D=r(80798),F=r(60906),T=r(72645),A=r(75186),N=r(64379),R=r(18947);async function M(){return await fetch("".concat("https://api.euphoria-messenger.uz","/roles/allNames"),{method:"GET",headers:{"Content-Type":"application/json"},credentials:"include"}).then(e=>e.json())}async function L(e,t,r,n,s){return await fetch("".concat("https://api.euphoria-messenger.uz","/users/update-user/").concat(e),{method:"PATCH",headers:{"Content-Type":"application/json"},credentials:"include",body:JSON.stringify({name:t,login:r,password:n,role:s})}).then(e=>e.json())}function O(e){let[t,r]=s.useState(!1),[a,i]=s.useState(!1),[c,d]=s.useState(e.role),[h,x]=s.useState(e.name),[p,m]=s.useState(e.login),[j,f]=s.useState(""),[g,v]=s.useState(!0),[O,q]=s.useState([]),[E,I]=s.useState(!1),[V,H]=s.useState(!1);return s.useEffect(()=>{(async()=>{try{let e=await M();q(e.data),v(!1)}catch(e){console.error("Failed to fetch roles:",e),v(!1)}})()},[]),s.useEffect(()=>{V&&(r(!1),I(!1),x(""),m(""),f(""),d(""),H(!1),window.location.reload())},[V]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(u.ZP,{size:"sm",color:"primary",onClick:()=>r(!0),children:(0,n.jsx)(R.Z,{})}),(0,n.jsx)(b.ZP,{open:t,onClose:()=>r(!1),children:(0,n.jsxs)(w.Z,{sx:{maxWidth:{xs:"94%",sm:"400px"},width:"100%",overflowY:"auto"},children:[(0,n.jsxs)(C.Z,{color:"primary",level:"h4",children:["Изменить пользователя",(0,n.jsx)(k.Z,{sx:{fontSize:24},color:"primary"})]}),(0,n.jsxs)(P.Z,{spacing:2,children:[(0,n.jsx)(S.Z,{required:!0,children:"Имя пользователя"}),(0,n.jsx)(o.ZP,{autoFocus:!0,required:!0,onChange:e=>x(e.target.value),value:h,endDecorator:(0,n.jsx)(T.Z,{})}),(0,n.jsx)(S.Z,{required:!0,children:"Логин"}),(0,n.jsx)(o.ZP,{required:!0,onChange:e=>m(e.target.value),value:p,endDecorator:(0,n.jsx)(z.Z,{})}),(0,n.jsx)(S.Z,{required:!0,children:"Пароль"}),(0,n.jsx)(o.ZP,{required:!0,onChange:e=>f(e.target.value),value:j,type:a?"text":"password",endDecorator:(0,n.jsx)(u.ZP,{variant:"plain","aria-label":a?"hide password":"show password",color:"neutral",size:"sm",onClick:()=>{i(!a)},children:a?(0,n.jsx)(D.Z,{}):(0,n.jsx)(F.Z,{})})}),(0,n.jsx)(S.Z,{required:!0,children:"Выберите роль"}),(0,n.jsx)(y.Z,{name:"role",required:!0,sx:{minWidth:200},value:c,onChange:(e,t)=>d(t),disabled:g,children:g?(0,n.jsx)(Z.Z,{value:"",disabled:!0,children:"Загрузка..."}):O.map(e=>(0,n.jsx)(Z.Z,{value:e.name,children:e.name},e.id))}),(0,n.jsx)(l.Z,{onClick:async()=>{I(!0);try{await L(e.id,h,p,j,c),A.ZP.success("Пользователь успешно изменен"),H(!0)}catch(e){console.error("Failed to update user:",e),A.ZP.error("Не удалось изменить пользователя"),I(!1)}},disabled:E,endDecorator:E?(0,n.jsx)(N.Z,{}):null,children:"Изменить"})]})]})})]})}function q(e){let{users:t}=e,[r,b]=(0,s.useState)(t),[w,C]=(0,s.useState)(1),[P,S]=(0,s.useState)(10),[k,z]=(0,s.useState)("asc"),D=e=>{var r;let n=null===(r=e.target.value)||void 0===r?void 0:r.toLowerCase();console.log(n),""===n?b(t):b(t.filter(e=>e.name.toLowerCase().includes(n)||e.login.toLowerCase().includes(n)))},F=e=>{C(e)},T=Math.max(1,Math.ceil((r?r.length:1)/P));return s.useEffect(()=>{fetch("".concat("https://api.euphoria-messenger.uz","/users/all"),{credentials:"include"}).then(e=>e.json()).then(e=>{b(e.data)})},[]),(0,n.jsxs)(n.Fragment,{children:[(0,n.jsx)(a.Z,{className:"SearchAndFilters-tabletUp",sx:{borderRadius:"sm",py:2,display:{xs:"none",sm:"flex"},flexWrap:"wrap",gap:1.5,"& > *":{minWidth:{xs:"120px",md:"160px"}}},children:(0,n.jsx)(i.Z,{sx:{flex:1},size:"sm",children:(0,n.jsx)(o.ZP,{size:"sm",placeholder:"Поиск пользователей",startDecorator:(0,n.jsx)(x.Z,{}),onInput:e=>D(e)})})}),(0,n.jsx)(d.Z,{className:"OrderTableContainer",variant:"outlined",sx:{display:{xs:"none",sm:"initial"},width:"100%",borderRadius:"sm",flexShrink:1,overflow:"auto",minHeight:0},children:(0,n.jsxs)(c.Z,{"aria-labelledby":"tableTitle",stickyHeader:!0,stickyFooter:!0,hoverRow:!0,sx:{"--TableCell-headBackground":"var(--joy-palette-background-level1)","--Table-headerUnderlineThickness":"1px","--TableRow-hoverBackground":"var(--joy-palette-background-level1)","--TableCell-paddingY":"8px","--TableCell-paddingX":"8px"},children:[(0,n.jsx)("thead",{children:(0,n.jsxs)("tr",{children:[(0,n.jsx)("th",{style:{width:"6%",textAlign:"center",padding:"12px 6px"},children:(0,n.jsx)(f.Z,{})}),(0,n.jsx)("th",{style:{width:200,padding:"16px 6px"},children:(0,n.jsx)(h.ZP,{children:"Имя"})}),(0,n.jsx)("th",{style:{width:200,padding:"16px 6px"},children:"Логин"}),(0,n.jsx)("th",{style:{width:200,padding:"16px 6px"},children:"Телефон"}),(0,n.jsx)("th",{style:{width:200,padding:"16px 6px"},children:(0,n.jsx)(h.ZP,{children:"Роль"})}),(0,n.jsx)("th",{style:{width:"15%",padding:"16px 6px"},children:"Дата создания"}),(0,n.jsx)("th",{style:{width:"6%",padding:"10px 6px",textAlign:"center"},children:(0,n.jsx)(j.Z,{})})]})}),(0,n.jsx)("tbody",{children:t&&r.map((e,t)=>(0,n.jsxs)("tr",{children:[(0,n.jsx)("td",{style:{textAlign:"center",width:120},children:t+1}),(0,n.jsx)("td",{children:(0,n.jsxs)(a.Z,{sx:{display:"flex",gap:2,alignItems:"center"},children:[(0,n.jsx)(g.Z,{size:"sm",fullname:e.name[0]}),(0,n.jsx)(h.ZP,{level:"body-xs",children:e.name})]})}),(0,n.jsx)("td",{children:(0,n.jsx)(a.Z,{sx:{display:"flex",flexDirection:"row",justifyContent:"space-between",paddingRight:"24px"},children:(0,n.jsx)(h.ZP,{level:"body-xs",children:e.login})})}),(0,n.jsx)("td",{children:(0,n.jsx)(h.ZP,{level:"body-xs",children:e.phoneNumber})}),(0,n.jsx)("td",{children:(0,n.jsx)(h.ZP,{level:"body-xs",children:e.role})}),(0,n.jsx)("td",{children:(0,n.jsx)(h.ZP,{level:"body-xs",children:e.created_at.slice(0,10)})}),(0,n.jsx)("td",{style:{textAlign:"center"},children:(0,n.jsx)(O,{id:e.id,name:e.name,login:e.login,role:e.role})})]},t))})]})}),(0,n.jsxs)(a.Z,{className:"Pagination",sx:{pt:2,gap:1,display:{xs:"none",md:"flex"},justifyContent:"space-between",alignItems:"center",position:"sticky",bottom:0,borderTop:"1px solid #ccc",p:2},children:[(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(h.ZP,{children:"Показать:"}),(0,n.jsx)(y.Z,{size:"sm",value:P,defaultValue:25,onChange:(e,t)=>{S(parseInt(String(t),10)),C(1)},indicator:(0,n.jsx)(v.Z,{}),sx:{ml:2,minWidth:80},children:[5,10,25,50].map(e=>(0,n.jsx)(Z.Z,{value:e,children:e},e))})]}),(0,n.jsxs)(a.Z,{sx:{display:"flex",alignItems:"center"},children:[(0,n.jsx)(l.Z,{size:"sm",variant:"outlined",color:"neutral",startDecorator:(0,n.jsx)(m.Z,{}),onClick:()=>F(w-1),disabled:1===w,children:"До"}),(0,n.jsx)(a.Z,{sx:{mx:2,display:"flex",alignItems:"center",gap:1},children:Array.from({length:T},(e,t)=>t+1).slice(0,10).map(e=>(0,n.jsx)(u.ZP,{size:"sm",variant:e===w?"solid":"outlined",color:"neutral",onClick:()=>F(e),children:e},e))}),(0,n.jsx)(l.Z,{size:"sm",variant:"outlined",color:"neutral",endDecorator:(0,n.jsx)(p.Z,{}),onClick:()=>F(w+1),disabled:w===T,children:"После"})]})]})]})}},36766:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(57437);r(2265);var s=r(87505),a=r(18467);let l="abcdefghijklmnopqrstuvwxyzабвгдеёжзийклмнопрстуфхцчшщьыэюя".split(""),i=e=>{let t=e.charCodeAt(0);return"#".concat((16777216+(13*t%200+55<<16)+(37*t%200+55<<8)+(61*t%200+55)).toString(16).slice(1))},o=e=>{let t=parseInt(e.slice(1,3),16);return .2126*t+.7152*parseInt(e.slice(3,5),16)+.0722*parseInt(e.slice(5,7),16)<128};function c(e){let{online:t=!1,fullname:r="",status:c,...d}=e,u=(e=>{if(!e)return"#CCCCCC";let t=e[0].toLowerCase();return l.includes(t)?i(t):"#CCCCCC"})(r),h=o(u)?"#FFFFFF":"#000000";return(0,n.jsx)("div",{children:c?(0,n.jsx)(s.Z,{color:"UserStatusOnline"===c.className?"success":"neutral",variant:t?"solid":"soft",size:"sm",anchorOrigin:{vertical:"bottom",horizontal:"right"},badgeInset:"4px 4px",children:(0,n.jsx)(a.Z,{...d,sx:{bgcolor:u,color:h},children:r[0]||""})}):(0,n.jsx)(a.Z,{...d,sx:{bgcolor:u,color:h},children:r[0]||""})})}},20460:function(e,t,r){"use strict";r.d(t,{Z:function(){return c}});var n=r(57437),s=r(2265),a=r(55773),l=r(53092),i=r(47820);let o=s.forwardRef(function(e,t){let{onChange:r,...s}=e;return(0,n.jsx)(a.oc,{...s,mask:"+998 (##) ###-##-##",definitions:{"#":/[0-9]/},onAccept:t=>r({target:{name:e.name,value:t}}),overwrite:!0})});function c(e){return(0,n.jsx)(l.ZP,{sx:{my:2},placeholder:"Номер телефона",value:e.phone,onChange:t=>e.setPhone(t.target.value),slotProps:{input:{component:o}},endDecorator:(0,n.jsx)(i.Z,{})})}}},function(e){e.O(0,[420,529,630,186,270,971,117,744],function(){return e(e.s=49633)}),_N_E=e.O()}]);